import{system as e,world as t}from"@minecraft/server";function r(e){const t=Number(e.replace(/[^-.0-9]+/g,""));return e=e.replace(/\s+/g,""),/\d+(?=y)/i.test(e)?3154e7*t:/\d+(?=w)/i.test(e)?6048e5*t:/\d+(?=d)/i.test(e)?864e5*t:/\d+(?=h)/i.test(e)?36e5*t:/\d+(?=m)/i.test(e)?6e4*t:/\d+(?=s)/i.test(e)?1e3*t:/\d+(?=ms|milliseconds?)/i.test(e)?t:void 0}export default function n(n){n.addCommand("mute",{description:"Mute a player",usage:"!mute <player> [timeString]",category:"Moderation",admin:!0,async onRun(n,a,o,s){let i=function(e){var t=/[^\s"]+|"([^"]*)"/gi,r=[];do{var n=t.exec(e);null!=n&&r.push(n[1]?n[1]:n[0])}while(null!=n);return r}(a.join(" "));if(!i.length)return s("ERROR Must include a player name");let u,m=i[0];for(const e of t.getPlayers())if(e.name.toLowerCase()==m.toLowerCase()){u=e;break}if(!u)return s(`ERROR Player: ${m} not found. Please make sure the player is online, and put quotes in the player name if their name has spaces.`);e.run((()=>{for(const e of u.getTags())e.startsWith("muted:")&&u.removeTag(e)}));let d="muted:perm",l=`Muted ${u.name} permanently`;if(i.length>1){let e=r(i[1]);if(!e)return s("ERROR Invalid time format! Example: 2h3m5s");d=`muted:${Date.now()+e}`,l=`Muted ${u.name} for ${function(e){return`${Math.floor(e/36e5)}h ${Math.floor(e%36e5/6e4)}m ${Math.floor(e%6e4/1e3)}s`}(e)}`}return e.run((()=>{u.addTag(d)})),s(`SUCCESS ${l}`)}}),n.addCommand("unmute",{description:"Unmutes a player",category:"Moderation",usage:"!unmute <player>",admin:!0,async onRun(r,n,a,o){let s,i=n.join(" ");for(const e of t.getPlayers())if(e.name.toLowerCase()==i.toLowerCase()){s=e;break}return s?(e.run((()=>{for(const e of s.getTags())e.startsWith("muted:")&&s.removeTag(e)})),o("SUCCESS Unmuted player!")):o("ERROR Player not found!")}})}